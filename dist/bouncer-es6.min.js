/*! formbouncerjs v1.4.6 | (c) 2021 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/bouncer */
class Bouncer{constructor(e,t){this.selector=e,this.targets=document.querySelectorAll(this.selector),this.settings=this.extend(this.defaults(),t||{}),this.validate=this.validate,this.validateAll=this.validateAll,this.destroy=this.destroy,this.init()}init(){this.addNoValidate(),document.addEventListener("blur",this.blurHandler.bind(this),!0),document.addEventListener("input",this.inputHandler.bind(this),!1),document.addEventListener("click",this.inputHandler.bind(this),!1),document.addEventListener("submit",this.submitHandler.bind(this),!1),this.settings.emitEvents&&this.emitEvent(document,"bouncerInitialized",{settings:this.settings})}defaults(){return{fieldClass:"error",errorElement:"div",errorClass:"error-message",fieldPrefix:"bouncer-field_",errorPrefix:"bouncer-error_",patterns:{email:/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*(\.\w{2,})+$/,url:/^(?:(?:https?|HTTPS?|ftp|FTP):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-zA-Z\u00a1-\uffff0-9]-*)*[a-zA-Z\u00a1-\uffff0-9]+)(?:\.(?:[a-zA-Z\u00a1-\uffff0-9]-*)*[a-zA-Z\u00a1-\uffff0-9]+)*(?:\.(?:[a-zA-Z\u00a1-\uffff]{2,}))\.?)(?::\d{2,5})?(?:[/?#]\S*)?$/,number:/^(?:[-+]?[0-9]*[.,]?[0-9]+)$/,color:/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/,date:/(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))/,time:/^(?:(0[0-9]|1[0-9]|2[0-3])(:[0-5][0-9]))$/,month:/^(?:(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])))$/},customValidations:{},messageAfterField:!0,messageCustom:"data-bouncer-message",messageTarget:"data-bouncer-target",messages:{missingValue:{checkbox:"This field is required.",radio:"Please select a value.",select:"Please select a value.","select-multiple":"Please select at least one value.",default:"Please fill out this field."},patternMismatch:{email:"Please enter a valid email address.",url:"Please enter a URL.",number:"Please enter a number",color:"Please match the following format: #rrggbb",date:"Please use the YYYY-MM-DD format",time:"Please use the 24-hour time format. Ex. 23:00",month:"Please use the YYYY-MM format",default:"Please match the requested format."},outOfRange:{over:"Please select a value that is no more than {max}.",under:"Please select a value that is no less than {min}."},wrongLength:{over:"Please shorten this text to no more than {maxLength} characters. You are currently using {length} characters.",under:"Please lengthen this text to {minLength} characters or more. You are currently using {length} characters."},fallback:"There was an error with this field."},disableSubmit:!1,emitEvents:!0}}blurHandler(e){e.target.form&&e.target.form.matches(this.selector)&&this.validate(e.target)}inputHandler(e){e.target.form&&e.target.form.matches(this.selector)&&e.target.classList.contains(this.settings.fieldClass)&&this.validate(e.target)}submitHandler(e){if(e.target.matches(this.selector)){e.preventDefault();const t=this.validateAll(e.target);if(0<t.length)return t[0].focus(),void this.emitEvent(e.target,"bouncerFormInvalid",{errors:t});this.settings.disableSubmit||e.target.submit(),this.settings.emitEvents&&this.emitEvent(e.target,"bouncerFormValid")}}validate(e,t){if(!e.disabled&&!e.readOnly&&"reset"!==e.type&&"submit"!==e.type&&"button"!==e.type){var r=this.extend(this.settings,t||{}),t=this.getErrors(e,r);if(!t.valid)return this.showError(e,t.errors,r),t;this.removeError(e,r)}}validateAll(t){const r=this;if(void 0===t)t=this.targets;else if((t="string"==typeof t?document.querySelectorAll(t):t)instanceof Element){let e=[];e.push(t),t=e}let a=[];return this.forEach(t,function(e){e=Array.prototype.filter.call(e.querySelectorAll("input, select, textarea"),function(e){e=r.validate(e);return e&&!e.valid});a.push(...e)}),a}destroy(){document.removeEventListener("blur",this.blurHandler,!0),document.removeEventListener("input",this.inputHandler,!1),document.removeEventListener("click",this.inputHandler,!1),document.removeEventListener("submit",this.submitHandler,!1),this.removeAllErrors(),this.removeNoValidate(),this.settings.emitEvents&&this.emitEvent(document,"bouncerDestroyed",{settings:this.settings}),this.settings=null}forEach(e,t){Array.prototype.forEach.call(e,t)}extend(){const r=this;let a={};return this.forEach(arguments,function(e){for(var t in e){if(!e.hasOwnProperty(t))return;"[object Object]"===Object.prototype.toString.call(e[t])?a[t]=r.extend(a[t],e[t]):a[t]=e[t]}}),a}emitEvent(e,t,r){"function"==typeof window.CustomEvent&&(r=new CustomEvent(t,{bubbles:!0,detail:r||{}}),e.dispatchEvent(r))}addNoValidate(){this.forEach(this.targets,function(e){e.setAttribute("novalidate",!0)})}removeNoValidate(){this.forEach(this.targets,function(e){e.removeAttribute("novalidate")})}missingValue(e){if(!e.hasAttribute("required"))return!1;if("checkbox"===e.type)return!e.checked;let t=e.value.length;return"radio"===e.type&&(t=Array.prototype.filter.call(e.form.querySelectorAll('[name="'+this.escapeCharacters(e.name)+'"]'),function(e){return e.checked}).length),t<1}patternMismatch(e,t){let r=e.getAttribute("pattern");return r=r?new RegExp("^(?:"+r+")$"):t.patterns[e.type],!(!r||!e.value||e.value.length<1)&&!e.value.match(r)}outOfRange(e){if(!e.value||e.value.length<1)return!1;var t=e.getAttribute("max"),r=e.getAttribute("min"),e=parseFloat(e.value);return t&&t<e?"over":!!(r&&e<r)&&"under"}wrongLength(e){if(!e.value||e.value.length<1)return!1;var t=e.getAttribute("maxlength"),r=e.getAttribute("minlength"),e=e.value.length;return t&&t<e?"over":!!(r&&e<r)&&"under"}runValidations(e,t){return{missingValue:this.missingValue(e),patternMismatch:this.patternMismatch(e,t),outOfRange:this.outOfRange(e),wrongLength:this.wrongLength(e)}}customValidations(e,t,r,a){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i](e,a));return t}hasErrors(e){for(var t in e)if(e[t])return!0;return!1}getErrors(e,t){var r=this.runValidations(e,t),r=this.customValidations(e,r,t.customValidations,t);return{valid:!this.hasErrors(r),errors:r}}escapeCharacters(e){let t=String(e);var r=t.length;let a=-1,i,s="";for(var n=t.charCodeAt(0);++a<r;){if(i=t.charCodeAt(a),0===i)throw new InvalidCharacterError("Invalid character: the input contains U+0000.");1<=i&&i<=31||127==i||0===a&&48<=i&&i<=57||1===a&&48<=i&&i<=57&&45===n?s+="\\"+i.toString(16)+" ":128<=i||45===i||95===i||48<=i&&i<=57||65<=i&&i<=90||97<=i&&i<=122?s+=t.charAt(a):s+="\\"+t.charAt(a)}return s}getFieldID(e,t,r){let a=e.name||e.id;return!a&&r&&(a=t.fieldPrefix+Math.floor(999*Math.random()),e.id=a),"checkbox"===e.type&&(a+="_"+(e.value||e.id)),a}getErrorField(e){var t;return e="radio"===(e="radio"===e.type&&e.name?(t=e.form.querySelectorAll('[name="'+this.escapeCharacters(e.name)+'"]'))[t.length-1]:e).type||"checkbox"===e.type?e.closest("label")||e.form.querySelector('[for="'+e.id+'"]')||e:e}getErrorLocation(e,t,r){var a=e.getAttribute(r.messageTarget);if(a){const i=e.form.querySelector(a);if(i)return i.firstChild||i.appendChild(document.createTextNode(""))}return r.messageAfterField?(t.nextSibling||t.parentNode.appendChild(document.createTextNode("")),t.nextSibling):t}createError(e,t){let r=document.createElement(t.errorElement);r.className=t.errorClass,r.id=t.errorPrefix+this.getFieldID(e,t,!0);var a=this.getErrorField(e);let i=this.getErrorLocation(e,a,t);return i.parentNode.insertBefore(r,i),r}getErrorMessage(t,r,a){var e,i=a.messages;if(r.missingValue){let e=i.missingValue[t.type]||i.missingValue.default;var s=t.getAttribute(a.messageCustom);return s&&(e=s),e}if(r.outOfRange){let e=i.outOfRange[r.outOfRange];var n=t.getAttribute(a.messageCustom);return n&&(e=n),e.replace("{max}",t.getAttribute("max")).replace("{min}",t.getAttribute("min")).replace("{length}",t.value.length)}if(r.wrongLength){let e=i.wrongLength[r.wrongLength];n=t.getAttribute(a.messageCustom);return n&&(e=n),e.replace("{maxLength}",t.getAttribute("maxlength")).replace("{minLength}",t.getAttribute("minlength")).replace("{length}",t.value.length)}if(r.patternMismatch){let e=i.patternMismatch[t.type]||i.patternMismatch.default;t=t.getAttribute(a.messageCustom);return t&&(e=t),e}for(e in a.customValidations)if(a.customValidations.hasOwnProperty(e)&&r[e]&&i[e])return i[e];return i.fallback}addErrorAttributes(e,t,r){e.classList.add(r.fieldClass),e.setAttribute("aria-describedby",t.id),e.setAttribute("aria-invalid",!0)}showErrorAttributes(e,t,r){const a=this;"radio"===e.type&&e.name&&Array.prototype.forEach.call(document.querySelectorAll('[name="'+e.name+'"]'),function(e){a.addErrorAttributes(e,t,r)}),this.addErrorAttributes(e,t,r)}showError(e,t,r){let a=e.form.querySelector("#"+this.escapeCharacters(r.errorPrefix+this.getFieldID(e,r)))||this.createError(e,r),i=this.getErrorMessage(e,t,r);a.textContent="function"==typeof i?i(e,r):i,this.showErrorAttributes(e,a,r),r.emitEvents&&this.emitEvent(e,"bouncerShowError",{errors:t})}removeAttributes(e,t){e.classList.remove(t.fieldClass),e.removeAttribute("aria-describedby"),e.removeAttribute("aria-invalid")}removeErrorAttributes(e,t){const r=this;"radio"===e.type&&e.name?Array.prototype.forEach.call(document.querySelectorAll('[name="'+e.name+'"]'),function(e){r.removeAttributes(e,t)}):this.removeAttributes(e,t)}removeError(e,t){let r=e.form.querySelector("#"+this.escapeCharacters(t.errorPrefix+this.getFieldID(e,t)));r&&(r.parentNode.removeChild(r),this.removeErrorAttributes(e,t),t.emitEvents&&this.emitEvent(e,"bouncerRemoveError"))}removeAllErrors(){const t=this;this.forEach(t.targets,function(e){t.forEach(e.querySelectorAll("input, select, textarea"),function(e){t.removeError(e,t.settings)})})}}export{Bouncer as Bouncer};